1. How many distinct skus have the brand “Polo fas”, and are either size “XXL” or “black” in color?

SELECT COUNT(DISTINCT(sku))
FROM skuinfo
WHERE brand='Polo fas' AND (size='XXL' OR color='black');

OUTPUT: 13623

2. There was one store in the database which had only 11 days in one of its months 
(in other words, that store/month/year combination only contained 11 days of transaction data). 
In what city and state was this store located?

SELECT city, state
FROM strinfo
WHERE store=(
SELECT store
FROM trnsact
GROUP BY store, EXTRACT(month from saledate), EXTRACT(year from saledate)
HAVING COUNT(DISTINCT(EXTRACT(day from saledate)))=11);

OUTPUT: ATLANTA GA

3. Which sku number had the greatest increase in total sales revenue from November to December?

SELECT TOP 1
sku,
SUM(CASE WHEN EXTRACT(MONTH FROM saledate)=11 THEN amt END) AS november_sales, 
SUM(CASE WHEN EXTRACT(MONTH FROM saledate)=12 THEN amt END) AS december_sales,
december_sales-november_sales as increase_in_sales
FROM trnsact
GROUP BY sku
ORDER BY increase_in_sales DESC;

OUTPUT:3949538

4. What vendor has the greatest number of distinct skus in the transaction table that do not exist in the skstinfo table?

SELECT TOP 1 COUNT(DISTINCT(s.sku)) AS count_skus, s.vendor
FROM
(SELECT DISTINCT(uniq_t_skus.sku) AS sku
FROM 
(SELECT DISTINCT(t.sku) AS sku
FROM trnsact t) AS uniq_t_skus
LEFT OUTER JOIN
(SELECT DISTINCT(s.sku) AS sku
FROM skstinfo s) AS uniq_s_skus
ON uniq_t_skus.sku=uniq_s_skus.sku
WHERE uniq_s_skus.sku IS NULL) AS uniq_t_skus_not_in_s
INNER JOIN skuinfo s
ON uniq_t_skus_not_in_s.sku=s.sku
GROUP BY s.vendor
ORDER BY count_skus DESC;

OUTPUT:5715232
